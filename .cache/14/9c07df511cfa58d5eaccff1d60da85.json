{"id":"cVJj","dependencies":[{"name":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/package.json","includedInParent":true,"mtime":1584771267802},{"name":"./cssNodes.js","loc":{"line":19,"column":23},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/css/_deps/vscode-css-languageservice/parser/cssSymbolScope.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/css/_deps/vscode-css-languageservice/parser/cssNodes.js"},{"name":"../utils/arrays.js","loc":{"line":20,"column":26},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/css/_deps/vscode-css-languageservice/parser/cssSymbolScope.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/css/_deps/vscode-css-languageservice/utils/arrays.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.Symbols=exports.ScopeBuilder=exports.Symbol=exports.GlobalScope=exports.Scope=void 0;var e=n(require(\"./cssNodes.js\")),t=require(\"../utils/arrays.js\");function r(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}var o=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(){function e(e,t){this.offset=e,this.length=t,this.symbols=[],this.parent=null,this.children=[]}return e.prototype.addChild=function(e){this.children.push(e),e.setParent(this)},e.prototype.setParent=function(e){this.parent=e},e.prototype.findScope=function(e,t){return void 0===t&&(t=0),this.offset<=e&&this.offset+this.length>e+t||this.offset===e&&this.length===t?this.findInScope(e,t):null},e.prototype.findInScope=function(e,r){void 0===r&&(r=0);var n=e+r,o=(0,t.findFirst)(this.children,function(e){return e.offset>n});if(0===o)return this;var i=this.children[o-1];return i.offset<=e&&i.offset+i.length>=e+r?i.findInScope(e,r):this},e.prototype.addSymbol=function(e){this.symbols.push(e)},e.prototype.getSymbol=function(e,t){for(var r=0;r<this.symbols.length;r++){var n=this.symbols[r];if(n.name===e&&n.type===t)return n}return null},e.prototype.getSymbols=function(){return this.symbols},e}();exports.Scope=i;var a=function(e){function t(){return e.call(this,0,Number.MAX_VALUE)||this}return o(t,e),t}(i);exports.GlobalScope=a;var s=function(){return function(e,t,r,n){this.name=e,this.value=t,this.node=r,this.type=n}}();exports.Symbol=s;var f=function(){function t(e){this.scope=e}return t.prototype.addSymbol=function(e,t,r,n){if(-1!==e.offset){var o=this.scope.findScope(e.offset,e.length);o&&o.addSymbol(new s(t,r,e,n))}},t.prototype.addScope=function(e){if(-1!==e.offset){var t=this.scope.findScope(e.offset,e.length);if(t&&(t.offset!==e.offset||t.length!==e.length)){var r=new i(e.offset,e.length);return t.addChild(r),r}return t}return null},t.prototype.addSymbolToChildScope=function(e,t,r,n,o){if(e&&-1!==e.offset){var i=this.addScope(e);i&&i.addSymbol(new s(r,n,t,o))}},t.prototype.visitNode=function(t){switch(t.type){case e.NodeType.Keyframe:return this.addSymbol(t,t.getName(),void 0,e.ReferenceType.Keyframe),!0;case e.NodeType.CustomPropertyDeclaration:return this.visitCustomPropertyDeclarationNode(t);case e.NodeType.VariableDeclaration:return this.visitVariableDeclarationNode(t);case e.NodeType.Ruleset:return this.visitRuleSet(t);case e.NodeType.MixinDeclaration:return this.addSymbol(t,t.getName(),void 0,e.ReferenceType.Mixin),!0;case e.NodeType.FunctionDeclaration:return this.addSymbol(t,t.getName(),void 0,e.ReferenceType.Function),!0;case e.NodeType.FunctionParameter:return this.visitFunctionParameterNode(t);case e.NodeType.Declarations:return this.addScope(t),!0;case e.NodeType.For:var r=t,n=r.getDeclarations();return n&&r.variable&&this.addSymbolToChildScope(n,r.variable,r.variable.getName(),void 0,e.ReferenceType.Variable),!0;case e.NodeType.Each:var o=t,i=o.getDeclarations();if(i)for(var a=0,s=o.getVariables().getChildren();a<s.length;a++){var f=s[a];this.addSymbolToChildScope(i,f,f.getName(),void 0,e.ReferenceType.Variable)}return!0}return!0},t.prototype.visitRuleSet=function(t){var r=this.scope.findScope(t.offset,t.length);if(r)for(var n=0,o=t.getSelectors().getChildren();n<o.length;n++){var i=o[n];i instanceof e.Selector&&1===i.getChildren().length&&r.addSymbol(new s(i.getChild(0).getText(),void 0,i,e.ReferenceType.Rule))}return!0},t.prototype.visitVariableDeclarationNode=function(t){var r=t.getValue()?t.getValue().getText():void 0;return this.addSymbol(t,t.getName(),r,e.ReferenceType.Variable),!0},t.prototype.visitFunctionParameterNode=function(t){var r=t.getParent().getDeclarations();if(r){var n=t.getDefaultValue(),o=n?n.getText():void 0;this.addSymbolToChildScope(r,t,t.getName(),o,e.ReferenceType.Variable)}return!0},t.prototype.visitCustomPropertyDeclarationNode=function(t){var r=t.getValue()?t.getValue().getText():\"\";return this.addCSSVariable(t.getProperty(),t.getProperty().getName(),r,e.ReferenceType.Variable),!0},t.prototype.addCSSVariable=function(e,t,r,n){-1!==e.offset&&this.scope.addSymbol(new s(t,r,e,n))},t}();exports.ScopeBuilder=f;var l=function(){function t(e){this.global=new a,e.acceptVisitor(new f(this.global))}return t.prototype.findSymbolsAtOffset=function(e,t){for(var r=this.global.findScope(e,0),n=[],o={};r;){for(var i=r.getSymbols(),a=0;a<i.length;a++){var s=i[a];s.type!==t||o[s.name]||(n.push(s),o[s.name]=!0)}r=r.parent}return n},t.prototype.internalFindSymbol=function(t,r){var n=t;if(t.parent instanceof e.FunctionParameter&&t.parent.getParent()instanceof e.BodyDeclaration&&(n=t.parent.getParent().getDeclarations()),t.parent instanceof e.FunctionArgument&&t.parent.getParent()instanceof e.Function){var o=t.parent.getParent().getIdentifier();if(o){var i=this.internalFindSymbol(o,[e.ReferenceType.Function]);i&&(n=i.node.getDeclarations())}}if(!n)return null;for(var a=t.getText(),s=this.global.findScope(n.offset,n.length);s;){for(var f=0;f<r.length;f++){var l=r[f],p=s.getSymbol(a,l);if(p)return p}s=s.parent}return null},t.prototype.evaluateReferenceTypes=function(t){if(t instanceof e.Identifier){var r=t.referenceTypes;if(r)return r;if(t.isCustomProperty)return[e.ReferenceType.Variable];var n=e.getParentDeclaration(t);if(n){var o=n.getNonPrefixedPropertyName();if((\"animation\"===o||\"animation-name\"===o)&&n.getValue()&&n.getValue().offset===t.offset)return[e.ReferenceType.Keyframe]}}else if(t instanceof e.Variable)return[e.ReferenceType.Variable];return t.findAParent(e.NodeType.Selector,e.NodeType.ExtendsReference)?[e.ReferenceType.Rule]:null},t.prototype.findSymbolFromNode=function(t){if(!t)return null;for(;t.type===e.NodeType.Interpolation;)t=t.getParent();var r=this.evaluateReferenceTypes(t);return r?this.internalFindSymbol(t,r):null},t.prototype.matchesSymbol=function(t,r){if(!t)return!1;for(;t.type===e.NodeType.Interpolation;)t=t.getParent();if(!t.matches(r.name))return!1;var n=this.evaluateReferenceTypes(t);return!(!n||-1===n.indexOf(r.type))&&this.internalFindSymbol(t,n)===r},t.prototype.findSymbol=function(e,t,r){for(var n=this.global.findScope(r);n;){var o=n.getSymbol(e,t);if(o)return o;n=n.parent}return null},t}();exports.Symbols=l;"},"sourceMaps":null,"error":null,"hash":"7715daa076e4023a93a18a1c625a0aa5","cacheData":{"env":{}}}