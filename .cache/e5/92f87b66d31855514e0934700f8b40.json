{"id":"VtNB","dependencies":[{"name":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/package.json","includedInParent":true,"mtime":1584771267802},{"name":"./../../jsonc-parser/main.js","loc":{"line":5,"column":22},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/services/jsonSchemaService.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/jsonc-parser/main.js"},{"name":"./../../vscode-uri/index.js","loc":{"line":6,"column":20},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/services/jsonSchemaService.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-uri/index.js"},{"name":"../utils/strings.js","loc":{"line":7,"column":25},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/services/jsonSchemaService.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/utils/strings.js"},{"name":"../parser/jsonParser.js","loc":{"line":8,"column":24},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/services/jsonSchemaService.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/parser/jsonParser.js"},{"name":"./../../../fillers/vscode-nls.js","loc":{"line":9,"column":21},"parent":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/_deps/vscode-json-languageservice/services/jsonSchemaService.js","resolved":"/Users/guoyaqi/work/2020/playground/node_modules/monaco-editor/esm/vs/language/json/fillers/vscode-nls.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.JSONSchemaService=exports.ResolvedSchema=exports.UnresolvedSchema=void 0;var e=o(require(\"./../../jsonc-parser/main.js\")),t=require(\"./../../vscode-uri/index.js\"),r=o(require(\"../utils/strings.js\")),s=o(require(\"../parser/jsonParser.js\")),n=o(require(\"./../../../fillers/vscode-nls.js\"));function i(){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=s?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}var a=n.loadMessageBundle(),c=function(){function e(e){try{this.patternRegExp=new RegExp(r.convertSimple2RegExpPattern(e)+\"$\")}catch(t){this.patternRegExp=null}this.schemas=[]}return e.prototype.addSchema=function(e){this.schemas.push(e)},e.prototype.matchesPattern=function(e){return this.patternRegExp&&this.patternRegExp.test(e)},e.prototype.getSchemas=function(){return this.schemas},e}(),h=function(){function e(e,t,r){this.service=e,this.url=t,this.dependencies={},r&&(this.unresolvedSchema=this.service.promise.resolve(new u(r)))}return e.prototype.getUnresolvedSchema=function(){return this.unresolvedSchema||(this.unresolvedSchema=this.service.loadSchema(this.url)),this.unresolvedSchema},e.prototype.getResolvedSchema=function(){var e=this;return this.resolvedSchema||(this.resolvedSchema=this.getUnresolvedSchema().then(function(t){return e.service.resolveSchemaContent(t,e.url,e.dependencies)})),this.resolvedSchema},e.prototype.clearSchema=function(){this.resolvedSchema=null,this.unresolvedSchema=null,this.dependencies={}},e}(),u=function(){return function(e,t){void 0===t&&(t=[]),this.schema=e,this.errors=t}}();exports.UnresolvedSchema=u;var l=function(){function e(e,t){void 0===t&&(t=[]),this.schema=e,this.errors=t}return e.prototype.getSection=function(e){return s.asSchema(this.getSectionRecursive(e,this.schema))},e.prototype.getSectionRecursive=function(e,t){if(!t||\"boolean\"==typeof t||0===e.length)return t;var r=e.shift();if(t.properties&&(t.properties[r],1))return this.getSectionRecursive(e,t.properties[r]);if(t.patternProperties)for(var s=0,n=Object.keys(t.patternProperties);s<n.length;s++){var i=n[s];if(new RegExp(i).test(r))return this.getSectionRecursive(e,t.patternProperties[i])}else{if(\"object\"==typeof t.additionalProperties)return this.getSectionRecursive(e,t.additionalProperties);if(r.match(\"[0-9]+\"))if(Array.isArray(t.items)){var o=parseInt(r,10);if(!isNaN(o)&&t.items[o])return this.getSectionRecursive(e,t.items[o])}else if(t.items)return this.getSectionRecursive(e,t.items)}return null},e}();exports.ResolvedSchema=l;var p=function(){function n(e,t,r){this.contextService=t,this.requestService=e,this.promiseConstructor=r||Promise,this.callOnDispose=[],this.contributionSchemas={},this.contributionAssociations={},this.schemasById={},this.filePatternAssociations=[],this.filePatternAssociationById={},this.registeredSchemasIds={}}return n.prototype.getRegisteredSchemaIds=function(e){return Object.keys(this.registeredSchemasIds).filter(function(r){var s=t.URI.parse(r).scheme;return\"schemaservice\"!==s&&(!e||e(s))})},Object.defineProperty(n.prototype,\"promise\",{get:function(){return this.promiseConstructor},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){for(;this.callOnDispose.length>0;)this.callOnDispose.pop()()},n.prototype.onResourceChange=function(e){for(var t=this,r=!1,s=[e=this.normalizeId(e)],n=Object.keys(this.schemasById).map(function(e){return t.schemasById[e]});s.length;)for(var i=s.pop(),o=0;o<n.length;o++){var a=n[o];a&&(a.url===i||a.dependencies[i])&&(a.url!==i&&s.push(a.url),a.clearSchema(),n[o]=void 0,r=!0)}return r},n.prototype.normalizeId=function(e){try{return t.URI.parse(e).toString()}catch(r){return e}},n.prototype.setSchemaContributions=function(e){if(e.schemas){var t=e.schemas;for(var r in t){var s=this.normalizeId(r);this.contributionSchemas[s]=this.addSchemaHandle(s,t[r])}}if(e.schemaAssociations){var n=e.schemaAssociations;for(var i in n){var o=n[i];this.contributionAssociations[i]=o;for(var a=this.getOrAddFilePatternAssociation(i),c=0,h=o;c<h.length;c++){var u=h[c];r=this.normalizeId(u);a.addSchema(r)}}}},n.prototype.addSchemaHandle=function(e,t){var r=new h(this,e,t);return this.schemasById[e]=r,r},n.prototype.getOrAddSchemaHandle=function(e,t){return this.schemasById[e]||this.addSchemaHandle(e,t)},n.prototype.getOrAddFilePatternAssociation=function(e){var t=this.filePatternAssociationById[e];return t||(t=new c(e),this.filePatternAssociationById[e]=t,this.filePatternAssociations.push(t)),t},n.prototype.registerExternalSchema=function(e,t,r){void 0===t&&(t=null);var s=this.normalizeId(e);if(this.registeredSchemasIds[s]=!0,t)for(var n=0,i=t;n<i.length;n++){var o=i[n];this.getOrAddFilePatternAssociation(o).addSchema(s)}return r?this.addSchemaHandle(s,r):this.getOrAddSchemaHandle(s)},n.prototype.clearExternalSchemas=function(){for(var e in this.schemasById={},this.filePatternAssociations=[],this.filePatternAssociationById={},this.registeredSchemasIds={},this.contributionSchemas)this.schemasById[e]=this.contributionSchemas[e],this.registeredSchemasIds[e]=!0;for(var t in this.contributionAssociations)for(var r=this.getOrAddFilePatternAssociation(t),s=0,n=this.contributionAssociations[t];s<n.length;s++){var i=n[s];e=this.normalizeId(i);r.addSchema(e)}},n.prototype.getResolvedSchema=function(e){var t=this.normalizeId(e),r=this.schemasById[t];return r?r.getResolvedSchema():this.promise.resolve(null)},n.prototype.loadSchema=function(t){if(!this.requestService){var s=a(\"json.schema.norequestservice\",\"Unable to load schema from '{0}'. No schema request service available\",f(t));return this.promise.resolve(new u({},[s]))}return this.requestService(t).then(function(r){if(!r){var s=a(\"json.schema.nocontent\",\"Unable to load schema from '{0}': No content.\",f(t));return new u({},[s])}var n,i=[];n=e.parse(r,i);var o=i.length?[a(\"json.schema.invalidFormat\",\"Unable to parse content from '{0}': Parse error at offset {1}.\",f(t),i[0].offset)]:[];return new u(n,o)},function(e){var s=e.toString(),n=e.toString().split(\"Error: \");return n.length>1&&(s=n[1]),r.endsWith(s,\".\")&&(s=s.substr(0,s.length-1)),new u({},[a(\"json.schema.nocontent\",\"Unable to load schema from '{0}': {1}.\",f(t),s)])})},n.prototype.resolveSchemaContent=function(e,t,r){var s=this,n=e.errors.slice(0),i=e.schema;if(i.$schema){var o=this.normalizeId(i.$schema);if(\"http://json-schema.org/draft-03/schema\"===o)return this.promise.resolve(new l({},[a(\"json.schema.draft03.notsupported\",\"Draft-03 schemas are not supported.\")]));\"https://json-schema.org/draft/2019-09/schema\"===o&&e.errors.push(a(\"json.schema.draft201909.notsupported\",\"Draft 2019-09 schemas are not yet fully supported.\"))}var c=this.contextService,h=function(e,t,r,s){var i=function(e,t){if(!t)return e;var r=e;return\"/\"===t[0]&&(t=t.substr(1)),t.split(\"/\").some(function(e){return!(r=r[e])}),r}(t,s);if(i)for(var o in i)i.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(e[o]=i[o]);else n.push(a(\"json.schema.invalidref\",\"$ref '{0}' in '{1}' can not be resolved.\",s,r))},u=function(e,t,r,i,o){c&&!/^\\w+:\\/\\/.*/.test(t)&&(t=c.resolveRelativePath(t,i)),t=s.normalizeId(t);var u=s.getOrAddSchemaHandle(t);return u.getUnresolvedSchema().then(function(s){if(o[t]=!0,s.errors.length){var i=r?t+\"#\"+r:t;n.push(a(\"json.schema.problemloadingref\",\"Problems loading reference '{0}': {1}\",i,s.errors[0]))}return h(e,s.schema,t,r),p(e,s.schema,t,u.dependencies)})},p=function(e,t,r,n){if(!e||\"object\"!=typeof e)return Promise.resolve(null);for(var i=[e],o=[],a=[],c=function(e){for(var s=[];e.$ref;){var o=e.$ref,c=o.split(\"#\",2);if(delete e.$ref,c[0].length>0)return void a.push(u(e,c[0],c[1],r,n));-1===s.indexOf(o)&&(h(e,t,r,c[1]),s.push(o))}!function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,s=e;r<s.length;r++){var n=s[r];\"object\"==typeof n&&i.push(n)}}(e.items,e.additionalProperties,e.not,e.contains,e.propertyNames,e.if,e.then,e.else),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,s=e;r<s.length;r++){var n=s[r];if(\"object\"==typeof n)for(var o in n){var a=n[o];\"object\"==typeof a&&i.push(a)}}}(e.definitions,e.properties,e.patternProperties,e.dependencies),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,s=e;r<s.length;r++){var n=s[r];if(Array.isArray(n))for(var o=0,a=n;o<a.length;o++){var c=a[o];\"object\"==typeof c&&i.push(c)}}}(e.anyOf,e.allOf,e.oneOf,e.items)};i.length;){var l=i.pop();o.indexOf(l)>=0||(o.push(l),c(l))}return s.promise.all(a)};return p(i,i,t,r).then(function(e){return new l(i,n)})},n.prototype.getSchemaForResource=function(e,t){if(t&&t.root&&\"object\"===t.root.type){var n=t.root.properties.filter(function(e){return\"$schema\"===e.keyNode.value&&e.valueNode&&\"string\"===e.valueNode.type});if(n.length>0){var i=s.getNodeValue(n[0].valueNode);if(i&&r.startsWith(i,\".\")&&this.contextService&&(i=this.contextService.resolveRelativePath(i,e)),i){var o=this.normalizeId(i);return this.getOrAddSchemaHandle(o).getResolvedSchema()}}}for(var a=Object.create(null),c=[],h=0,u=this.filePatternAssociations;h<u.length;h++){var l=u[h];if(l.matchesPattern(e))for(var p=0,f=l.getSchemas();p<f.length;p++){var d=f[p];a[d]||(c.push(d),a[d]=!0)}}return c.length>0?this.createCombinedSchema(e,c).getResolvedSchema():this.promise.resolve(null)},n.prototype.createCombinedSchema=function(e,t){if(1===t.length)return this.getOrAddSchemaHandle(t[0]);var r=\"schemaservice://combinedSchema/\"+encodeURIComponent(e),s={allOf:t.map(function(e){return{$ref:e}})};return this.addSchemaHandle(r,s)},n}();function f(e){try{var r=t.URI.parse(e);if(\"file\"===r.scheme)return r.fsPath}catch(s){}return e}exports.JSONSchemaService=p;"},"sourceMaps":null,"error":null,"hash":"6e63563b4ee620d92fc4eb52463fba4e","cacheData":{"env":{}}}